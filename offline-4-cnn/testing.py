# python
from codes.utils import *
import numpy as np

kernel = np.random.randn(2, 3)   # height: 2, width: 3
'''
kernel
>> array([[-1.04431019,  0.76923148,  1.56285333],
       [-1.39115846, -0.81469269,  1.3834697 ]])
kernel.shape
>> (2, 3)
'''


kernel = np.random.randn(2, 3)

kernel
# array([[-1.04431019,  0.76923148,  1.56285333],
#        [-1.39115846, -0.81469269,  1.3834697 ]])
kernel.shape
# (2, 3)
a = np.arange(5)

a
# array([0, 1, 2, 3, 4])
b = np.repeat(a, 5)

b
# array([0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 2, 2, 2, 2, 2, 3, 3, 3, 3, 3, 4, 4,
#        4, 4, 4])
c = np.tile(b, 3)

c
# array([0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 2, 2, 2, 2, 2, 3, 3, 3, 3, 3, 4, 4,
#        4, 4, 4, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 2, 2, 2, 2, 2, 3, 3, 3, 3,
#        3, 4, 4, 4, 4, 4, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 2, 2, 2, 2, 2, 3,
#        3, 3, 3, 3, 4, 4, 4, 4, 4])
c.shape
# (75,)
ev_lev = 2 * np.repeat(np.arange(5), 5)

ev_lev.shape
# (25,)
ev_lev.reshape(1, -1)
# array([[0, 0, 0, 0, 0, 2, 2, 2, 2, 2, 4, 4, 4, 4, 4, 6, 6, 6, 6, 6, 8, 8,
#         8, 8, 8]])
i = c.reshape(-1, 1) + ev_lev.reshape(1, -1)

i.shape
# (75, 25)
i[5]
# array([1, 1, 1, 1, 1, 3, 3, 3, 3, 3, 5, 5, 5, 5, 5, 7, 7, 7, 7, 7, 9, 9,
#        9, 9, 9])
X = np.random.randint(0, 10, (1, 3, 5, 5))
X
# array([[[[9, 6, 9, 2, 3],
#          [7, 4, 0, 0, 2],
#          [5, 6, 5, 6, 8],
#          [9, 8, 0, 6, 2],
#          [8, 3, 5, 9, 0]],

#         [[9, 7, 2, 2, 2],
#          [3, 5, 3, 2, 9],
#          [7, 7, 1, 4, 5],
#          [2, 1, 9, 6, 1],
#          [5, 9, 5, 3, 5]],

#         [[6, 8, 2, 7, 4],
#          [4, 7, 0, 2, 2],
#          [3, 1, 0, 6, 1],
#          [8, 0, 7, 7, 2],
#          [4, 4, 0, 3, 1]]]])
filter_h = 3
filter_w = 3
stride = 2
padding = 1

X_cols = im2col(X, filter_h, filter_w, stride, padding)

X_cols.shape
# (27, 9)
X_cols
# array([[0, 0, 0, 0, 4, 0, 0, 8, 6],
#        [0, 0, 0, 7, 0, 2, 9, 0, 2],
#        [0, 0, 0, 4, 0, 0, 8, 6, 0],
#        [0, 6, 2, 0, 6, 6, 0, 3, 9],
#        [9, 9, 3, 5, 5, 8, 8, 5, 0],
#        [6, 2, 0, 6, 6, 0, 3, 9, 0],
#        [0, 4, 0, 0, 8, 6, 0, 0, 0],
#        [7, 0, 2, 9, 0, 2, 0, 0, 0],
#        [4, 0, 0, 8, 6, 0, 0, 0, 0],
#        [0, 0, 0, 0, 5, 2, 0, 1, 6],
#        [0, 0, 0, 3, 3, 9, 2, 9, 1],
#        [0, 0, 0, 5, 2, 0, 1, 6, 0],
#        [0, 7, 2, 0, 7, 4, 0, 9, 3],
#        [9, 2, 2, 7, 1, 5, 5, 5, 5],
#        [7, 2, 0, 7, 4, 0, 9, 3, 0],
#        [0, 5, 2, 0, 1, 6, 0, 0, 0],
#        [3, 3, 9, 2, 9, 1, 0, 0, 0],
#        [5, 2, 0, 1, 6, 0, 0, 0, 0],
#        [0, 0, 0, 0, 7, 2, 0, 0, 7],
#        [0, 0, 0, 4, 0, 2, 8, 7, 2],
#        [0, 0, 0, 7, 2, 0, 0, 7, 0],
#        [0, 8, 7, 0, 1, 6, 0, 4, 3],
#        [6, 2, 4, 3, 0, 1, 4, 0, 1],
#        [8, 7, 0, 1, 6, 0, 4, 3, 0],
#        [0, 7, 2, 0, 0, 7, 0, 0, 0],
#        [4, 0, 2, 8, 7, 2, 0, 0, 0],
#        [7, 2, 0, 0, 7, 0, 0, 0, 0]])
